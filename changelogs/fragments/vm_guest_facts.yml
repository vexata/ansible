bugfixes:
    - simple code collapse, avoid a lot of repetition
